___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community Template Gallery Developer Terms of Service available at https://developers.google.com/tag-manager/gallery-tos (or such other URL as Google may provide), as modified from time to time.

ï»¿___INFO___

{
  "displayName": "Indicative Analytics",
  "description": "This tag implements basic event tracking for use in Indicative.",
  "categories": ["ANALYTICS", "ATTRIBUTION", "CONVERSIONS", "DATA_WAREHOUSING", "EMAIL_MARKETING"],
  "securityGroups": [],
  "id": "cvt_temp_public_id",
  "type": "TAG",
  "version": 1.01,
  "brand": {
    "thumbnail": "data:image/png;base64,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WEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIgldACAWEIHAIg1M7UAnOXesK7lellHncsFu93v+1p1Xa3GYZIjZOUC8Iixxmqq6rknnqqfeuqH6ur8CYPETsuhr0Xb1dX5pc3CmRyhA8Aj+rGvWdvW537sZ+t3P/zx6hpPOrDbgyhu6nA2r7HvJzdKQgeAR4wP78x/YLOTs2hrkrfqTMowDtuvr5qJHZfQAeBM2+cuJvrsBdMztcgpf3UFACQTOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBALKEDAMQSOgBArJmpBeAsTdMYGx7LOI6THCihA8CZpnrxgscldAB4RNu21fd9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",
    "displayName": "",
    "id": "brand_dummy"
  },
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "notSetText": "An API key is required.",
    "help": "You can create a project API Key by navigating to the 'Projects' section at <a href=\"https://app.indicative.com/\">https://app.indicative.com</a>. \n\nContact support@indicative.com for questions.",
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "displayName": "API Key",
    "simpleValueType": true,
    "name": "apiKey",
    "type": "TEXT"
  },
  {
    "help": "Choose what this tag does. <strong>Initialization</strong> only initializes the SDK and sends the Page View event. All the other options <strong>also</strong> initialize and send the Page View if not done already.",
    "alwaysInSummary": true,
    "selectItems": [
      {
        "displayValue": "Initialization",
        "value": "init"
      },
      {
        "displayValue": "Custom Event",
        "value": "event"
      },
      {
        "displayValue": "Clear Stateful Properties",
        "value": "clearProperties"
      },
      {
        "displayValue": "Clear Unique ID",
        "value": "clearUniqueId"
      }
    ],
    "displayName": "Tag Type",
    "defaultValue": "init",
    "simpleValueType": true,
    "name": "tagType",
    "type": "SELECT"
  },
  {
    "enablingConditions": [
      {
        "paramName": "tagType",
        "type": "EQUALS",
        "paramValue": "event"
      }
    ],
    "valueValidators": [
      {
        "type": "NON_EMPTY"
      }
    ],
    "displayName": "Event Name",
    "simpleValueType": true,
    "name": "eventName",
    "type": "TEXT"
  },
  {
    "enablingConditions": [
      {
        "paramName": "tagType",
        "type": "EQUALS",
        "paramValue": "init"
      },
      {
        "paramName": "tagType",
        "type": "EQUALS",
        "paramValue": "event"
      }
    ],
    "defaultValue": false,
    "simpleValueType": true,
    "name": "setUid",
    "checkboxText": "Set Custom Unique ID",
    "type": "CHECKBOX",
    "subParams": [
      {
        "enablingConditions": [
          {
            "paramName": "setUid",
            "type": "EQUALS",
            "paramValue": true
          }
        ],
        "valueValidators": [],
        "displayName": "Unique ID",
        "simpleValueType": true,
        "name": "uniqueId",
        "type": "TEXT"
      },
      {
        "help": "Set an alias for the Unique ID. See <a href=\"https://support.indicative.com/hc/en-us/articles/360004193571-Aliasing\">this documentation</a> for more information.",
        "enablingConditions": [
          {
            "paramName": "setUid",
            "type": "EQUALS",
            "paramValue": true
          }
        ],
        "simpleValueType": true,
        "name": "alias",
        "checkboxText": "Set as Alias",
        "type": "CHECKBOX"
      }
    ]
  },
  {
    "enablingConditions": [
      {
        "paramName": "tagType",
        "type": "EQUALS",
        "paramValue": "clearProperties"
      }
    ],
    "displayName": "Which properties should be cleared",
    "simpleValueType": true,
    "name": "propertiesToClear",
    "type": "RADIO",
    "radioItems": [
      {
        "displayValue": "Clear all stateful properties",
        "value": "clearAll"
      },
      {
        "displayValue": "Clear specific stateful properties",
        "value": "clearSome"
      }
    ]
  },
  {
    "enablingConditions": [
      {
        "paramName": "propertiesToClear",
        "type": "EQUALS",
        "paramValue": "clearSome"
      }
    ],
    "name": "clearProperties",
    "simpleTableColumns": [
      {
        "defaultValue": "",
        "displayName": "Property name",
        "name": "name",
        "isUnique": true,
        "type": "TEXT"
      }
    ],
    "type": "SIMPLE_TABLE",
    "newRowButtonText": "Add stateful property to clear"
  },
  {
    "displayName": "Main configuration",
    "name": "mainConfig",
    "groupStyle": "ZIPPY_CLOSED",
    "type": "GROUP",
    "subParams": [
      {
        "defaultValue": true,
        "simpleValueType": true,
        "name": "recordSessions",
        "checkboxText": "Track Sessions",
        "type": "CHECKBOX"
      },
      {
        "valueValidators": [
          {
            "type": "POSITIVE_NUMBER"
          },
          {
            "type": "NON_EMPTY"
          }
        ],
        "enablingConditions": [
          {
            "paramName": "recordSessions",
            "type": "EQUALS",
            "paramValue": true
          }
        ],
        "displayName": "Session Timeout Threshold",
        "defaultValue": 30,
        "simpleValueType": true,
        "name": "sessionsThreshold",
        "valueUnit": "minutes",
        "type": "TEXT"
      },
      {
        "help": "",
        "displayName": "Write Cookies On",
        "simpleValueType": true,
        "name": "cookiesOnMainDomain",
        "type": "RADIO",
        "radioItems": [
          {
            "displayValue": "Main domain (for tracking across subdomains)",
            "help": "",
            "value": true
          },
          {
            "displayValue": "Current domain",
            "help": "",
            "value": false
          }
        ]
      }
    ]
  },
  {
    "enablingConditions": [
      {
        "paramName": "tagType",
        "type": "EQUALS",
        "paramValue": "event"
      }
    ],
    "displayName": "Custom properties",
    "name": "customProperties",
    "groupStyle": "ZIPPY_CLOSED",
    "type": "GROUP",
    "subParams": [
      {
        "name": "properties",
        "simpleTableColumns": [
          {
            "defaultValue": "",
            "displayName": "Property name",
            "name": "name",
            "isUnique": true,
            "type": "TEXT"
          },
          {
            "defaultValue": "",
            "displayName": "Property value",
            "name": "value",
            "type": "TEXT"
          },
          {
            "selectItems": [
              {
                "displayValue": "Event property",
                "value": "event"
              },
              {
                "displayValue": "Stateful property",
                "value": "stateful"
              }
            ],
            "defaultValue": "event",
            "displayName": "Property type",
            "name": "type",
            "type": "SELECT"
          }
        ],
        "type": "SIMPLE_TABLE",
        "newRowButtonText": "Add new property"
      }
    ]
  }
]


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://cdn.indicative.com/js/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": [
        {
          "key": "keys",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.initialize"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.buildEvent"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.setUniqueID"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.addProperties"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.initalized"
                  },
                  {
                    "type": 8,
                    "boolean": true
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.clearUniqueID"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.removeProperty"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              },
              {
                "type": 3,
                "mapKey": [
                  {
                    "type": 1,
                    "string": "key"
                  },
                  {
                    "type": 1,
                    "string": "read"
                  },
                  {
                    "type": 1,
                    "string": "write"
                  },
                  {
                    "type": 1,
                    "string": "execute"
                  }
                ],
                "mapValue": [
                  {
                    "type": 1,
                    "string": "Indicative.clearProperties"
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": false
                  },
                  {
                    "type": 8,
                    "boolean": true
                  }
                ]
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

// Require the necessary APIs
const injectScript = require('injectScript');
const copyFromWindow = require('copyFromWindow');
const callInWindow = require('callInWindow');
const makeTableMap = require('makeTableMap');

const endpoint = 'https://cdn.indicative.com/js/Indicative.js'; //not minimized version for testing

const eventProps = data.properties ? makeTableMap(data.properties.filter(prop => prop.type === 'event'), 'name', 'value') : {};
const statefulProps = data.properties ? makeTableMap(data.properties.filter(prop => prop.type === 'stateful'), 'name', 'value') : {};

const onSuccess = () => {

  // Check if Indicative has already been initialized. If not, do so and send the Page View.
  const initialized = copyFromWindow('Indicative.initalized');
  if (!initialized) {
    callInWindow('Indicative.initialize', data.apiKey, {
      recordSessions: data.recordSessions,
      sessionsThreshold: data.sessionsThreshold,
      cookiesOnMainDomain: data.cookiesOnMainDomain
    });
    
    // If unique ID has been configured, set it.
    if (data.uniqueId) {
      callInWindow('Indicative.setUniqueID', data.uniqueId, data.alias);
  	}

    callInWindow('Indicative.buildEvent', 'Page View');
  }
  
  switch(data.tagType) {
    // If user wants to clear the unique ID
    case 'clearUniqueId':
      callInWindow('Indicative.clearUniqueID');
      break;
    // If user wants to remove custom properties
    case 'clearProperties':
      if (data.propertiesToClear === 'clearAll') {
        callInWindow('Indicative.clearProperties');
      } else if (data.propertiesToClear === 'clearSome') {
        data.clearProperties.forEach(prop => callInWindow('Indicative.removeProperty', prop.name));
      }
      break;
    // If user wants to send an event
    case 'event':
      // If User ID has been configured, set it.
      if (data.uniqueId) {
        callInWindow('Indicative.setUniqueID', data.uniqueId, data.alias);
      }
      // Set stateful properties
      callInWindow('Indicative.addProperties', statefulProps);
      // Send event
      callInWindow('Indicative.buildEvent', data.eventName, eventProps);
      break;
    default:
      break;
  }
  
  // Signal completion
  data.gtmOnSuccess();
  
};
injectScript(endpoint, onSuccess, data.gtmOnFailure, 'Indicative');


___NOTES___

Created on 8/7/2019, 1:53:21 PM
